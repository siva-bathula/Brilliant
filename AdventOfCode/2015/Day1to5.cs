using GenericDefs.DotNet;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;

namespace AdventOfCode
{
    public class Day1to5
    {
        public static void Solve()
        {
            Day5.CountNiceStringsPart2();
        }

        internal class Day1
        {
            internal static string Input = "()(((()))(()()()((((()(((())(()(()((((((()(()(((())))((()(((()))((())(()((()()()()(((())(((((((())))()()(()(()(())(((((()()()((())(((((()()))))()(())(((())(())((((((())())))(()())))()))))()())()())((()()((()()()()(()((((((((()()())((()()(((((()(((())((())(()))()((((()((((((((())()((()())(())((()))())((((()())(((((((((((()()(((((()(()))())(((()(()))())((()(()())())())(()(((())(())())()()(()(()((()))((()))))((((()(((()))))((((()(()(()())())()(((()((((())((((()(((()()(())()()()())((()((((((()((()()))()((()))()(()()((())))(((()(((()))((()((()(()))(((()()(()(()()()))))()()(((()(((())())))))((()(((())()(()(())((()())))((((())))(()(()(()())()((()())))(((()((()(())()()((()((())(()()((())(())()))()))((()(())()))())(((((((()(()()(()(())())))))))(()((((((())((((())((())())(()()))))()(())(()())()())((())(()))))(()))(()((()))()(()((((((()()()()((((((((()(()(())((()()(()()))(())()())()((())))()))()())(((()))(())()(())()))()((()((()(()()())(())()()()((())())))((()()(()()((()(())()()())(((()(()()))))(())))(()(()())()))()()))))))()))))((((((())))())))(()(())())(()())))))(()))()))))))()((()))))()))))(()(()((()())())(()()))))(((())()))())())())(((()(()()))(())()(())(())((((((()()))))((()(()))))))(()))())(((()()(()))()())()()()())))))))))))))(())(()))(()))((()(())(()())(())())(()())(())()()(()())))()()()))(())())()))())())(())((())))))))(())))(())))))()))))((())(()(((()))))(()))()((()(())))(()())(((((()))()())()()))))()))))()))())(()(()()()))()))))))((()))))))))))()((()))((()(())((())()()(()()))()(()))))()()(()))()))(((())))(())()((())(())(()())()())())))))))())))()((())))()))(()))()()))(((((((()))())(()()))(()()(()))()(()((()())()))))))(((()()()())))(())()))()())(()()))()()))))))))(())))()))()()))))))()))()())))()(())(())))))()(())()()(()()))))())((()))))()))))(()(((((()))))))))())))())()(())()()))))(())))())()()())()()())()(()))))()))()))))))))())))((()))()))()))())))()())()()())))())))(()((())()((()))())))))())()(())((())))))))))))())()())(())())())(()))(()))()))())(()(())())()())()()(()))))(()(())))))))(())))())(())))))))())()()(())())())))(())))))()))()(()())()(()))())())))))()()(()))()))))())))))))))()))))()))))))())()())()()))))()())))())))))))))))()()))))()()(((()))()()(())()))))((()))))(()))(())())))(())()))))))(()))()))))(())())))))()))(()())))))))))))))())))))))))()((()())(()())))))))((()))))(())(())))()(()())())))())())(()()()())))()))))))())))))())()()())))))))))))()()(()))))()())()))((()())(()))))()(()))))))))))()())())(((())(()))))())()))()))()))))))()))))))(()))))()))))()(())))(())))(()))())()()(()()))()))(()()))))))))()))(()))())(()()(()(()())()()))()))))))))(())))))((()()(()))())())))))()))())(()())()()))())))()(()()()()))((())())))())()(()()))()))))))))(()))(())))()))))(()(()())(()))))()())())()))()()))())))))))))))())()))))))()))))))))())))))()))))())(()())))(())()))())())))))()()(()()())(()())))()()))(((()))(()()()))))()))))()))))((())))()((((((()()))))))())))))))))))(((()))))))))))))(())())))))())(()))))))(()))((()))())))()(()((()))()))()))))))))))())()))()(()()))))())))())(())()(()))()))())(()))()))))(()()))()()(())))))()))(())(()(()()))(()()())))))(((()))))))()))))))))))))(())(()))))()())())()()((()()))())))))(()))))())))))))()()()))))))))())))()(((()()))(())))))(((())())))))((()))()(()))(()))))(()())))(()))())))))()))))(())(())))()((()))(())())))()()))()))))))))()))(()()()(()()()(()))())(())()())(((()))(())))))))))(((()())))()()))))))))()(())(()))()((((())(())(()())))()))(((())()()()))((()))(()))())())))())))(()))())()())())(()(())())()()()(())))())(())))(())))(())()))()))(()((()))))))))())(()))))))())(()()))()()))()(()(()())))()()(()((()((((((()))(())))()()()))())()))((()()(()))())((()(()(()))(()()))))()())))()))()())))))))()()((()())(())))()))(()))(())(()))())(()(())))()()))))))(((()(((()()))()(()(())())((()()))()))()))()))()(()()()(()))((()())()(())))()()))(((())()()())(())()((()()()()(()(())(()()))()(((((()())))((())))))(()()()))))(((()(())))()))((()((()(())()(()((())))((()())()(()))(((()())()()(()))(())(((()((()())()((())()())(((()()))((()((())(()))(()())(()()()))((()))(())(()((()()())((()))(())))(())(())(())))(()())))(((((()(()(((((()())((((()(()())(())(()()(((())((()(((()()(((()()((((((())))())(()((((((()(()))()))()()((()((()))))()(()()(()((()()))))))(((((()(((((())()()()(())())))))))()))((()()(())))(())(()()()())))))(()((((())))))))()()(((()(()(()(()(()())()()()(((((((((()()())()(()))((()()()()()(((((((()())()((())()))((((((()(()(()(()())(((()(((((((()(((())(((((((((())(())())()))((()(()))(((()()())(())(()(()()(((()(())()))())))(())((((((())(()()())()()(((()(((())(()(((())(((((((()(((((((((()))(())(()(()(()))))((()))()(())())())((()(()((()()))((()()((()(())(())(()((())(((())(((()()()((((((()()(())((((())()))))(())((()(()((())))(((((()(()()())())((())())))((())((()((()()((((((())(((()()(()())())(()(()))(()(()))())())()(((((((()(((()(())()()((())((()(()()((()(()()(((((((((((())((())((((((())((()((((()(()((((()(((((((())()((()))))())()((()((((()(()(((()((()())))(())())(((()(((())((((((()(((((((((()()(())))(()(((((()((((()())))((()((()((()(()()(((())((((((((((((()(((())(()(((((()))(()()(()()()()()()((())(((((((())(((((())))))())()(()()(()(()(((()()(((((())(()((()((()(((()()((()((((())()))()((((())(())))()())(((())(())(()()((()(((()()((((((((((()()(()())())(((((((((())((((()))()()((((())(()((((()(((())())(((((((((((()((((())))(())(()(((()(((()((())(((((()((()()(()(()()((((((()((((()((()(()((()(()((((((()))))()()(((((()((()(()(())()))(())(((((((()((((()())(()((()((()(()))())))(())((()))))(((((((()()()())(()))(()()((()())()((()((()()()(()(()()))(()())(())(((((()(((((((((((()((()(((()(((((((()()((((((()(((((()(()((()(((((())((((((()))((((())((()()((())(((())()(((((()()(((((()((()(()(((((((()(((((()((()((()((())(())((())(()))()()))(()()(()(()()(((((((()(((()(((())()(((((()((((((()())((((())()((()((()(()()())(()))((((()()((((((()((()(()(()((((()((()((())((((((()(()(())((((((()((((((((((()((())()))()(()(()(((((()()()))((())))()(()((((((((((((((()(((()((((()((())((()((()(((()()(()(((()((())(()()())))()(()(()(((((()()(()(()((((()(((((())()(()(()))(((((()()(((()()(())((((((((((((((())((())(((((((((((())()()()(())()(()(()(((((((((())(((()))(()()())(()((((()(())(((((()())(())((((((((())()((((()((((((())(()((()(())(((()((((()))(((((((((()()))((((()(())()()()(())(()((())((()()))()(((())(((((())((((((()()))(((((((((()((((((())))(((((((()((()(()(())))())(()(()))()(((((()())(()))()(()(())(((()))))())()())))(((((()))())()((()(()))))((()()()((((((()))()()((((((((())((()(()(((()(()((())((()())(()((((())(()(((()()()(()(()()))())())((((((((((())())((()))()((())(())(())))())()(()()(())))())(()))(((()(()()(((()(((())))()(((()(())()((((((())()))()))()((((((()(()(((((()())))()))))())()()(((()(((((())((()()(()((()((()(()(()(())))(()()()()((()(())(((()((()))((((()))())(())))())(()))()()()())()))(((()()())()((())))(())(()()()()(()())((()(()()((((())))((()((()(())((()(()((())()(()()(((()())()()())((()))((())(((()()(())))()()))(((()((())()(((((()())(())((())()())())((((((()(()(((((()))(()(";
            /// <summary>
            /// http://adventofcode.com/day/1
            /// </summary>
            public static void SolvePart2()
            {
                int counter = 0;
                int n = 0;
                foreach (char ch in Input)
                {
                    n++;
                    if (ch == '(') counter++;
                    else if (ch == ')') counter--;
                    if (counter == -1) break;
                }

                QueuedConsole.WriteImmediate("Santa enters basement at this character. {0}", n);
            }
        }

        internal class Day2
        {
            internal static void FindTotalWrappingPaper()
            {
                int totalSqFt = 0;
                using (var stream = Utility.GetEmbeddedResourceStream("AdventOfCode.Data.Day2.txt", true))
                {
                    using (StreamReader sr = new StreamReader(stream))
                    {
                        string s = string.Empty;
                        while ((s = sr.ReadLine()) != null)
                        {
                            string[] split = s.Split(new char[] { 'x' });
                            int l = int.Parse(split[0]);
                            int w = int.Parse(split[1]);
                            int h = int.Parse(split[2]);
                            int[] arr = new int[] { l * w, w * h, l * h };
                            totalSqFt += 2 * arr.Sum(x => x) + arr.Min();
                        }
                    }
                }

                QueuedConsole.WriteImmediate("Total square feet of wrapping paper. {0}", totalSqFt);
            }

            internal static void FindRibbonLength()
            {
                int totalSqFt = 0;
                using (var stream = Utility.GetEmbeddedResourceStream("AdventOfCode.Data.Day2.txt", true))
                {
                    using (StreamReader sr = new StreamReader(stream))
                    {
                        string s = string.Empty;
                        while ((s = sr.ReadLine()) != null)
                        {
                            string[] split = s.Split(new char[] { 'x' });
                            int l = int.Parse(split[0]);
                            int w = int.Parse(split[1]);
                            int h = int.Parse(split[2]);
                            int[] arr = new int[] { l + w, w + h, l + h };
                            totalSqFt += l * w * h + 2 * arr.Min();
                        }
                    }
                }

                QueuedConsole.WriteImmediate("Total square feet of ribbon : {0}", totalSqFt);
            }
        }

        internal class Day3
        {
            internal static void SantaDeliversPresents()
            {
                string s = string.Empty;
                using (var stream = Utility.GetEmbeddedResourceStream("AdventOfCode.Data.Day3.txt", true))
                {
                    using (StreamReader sr = new StreamReader(stream))
                    {
                        while ((s = sr.ReadLine()) != null)
                        {
                            break;
                        }
                    }
                }

                Dictionary<string, int> presents = new Dictionary<string, int>();
                int curX = 0, curY = 0;
                presents.Add("0#0", 1);
                foreach(char c in s)
                {
                    if (c == '>') curX += 1;
                    else if (c == '<') curX -= 1;
                    else if (c == '^') curY += 1;
                    else if (c == 'v') curY -= 1;

                    string curPos = curX + "#" + curY;
                    if (presents.ContainsKey(curPos)) presents[curPos] += 1;
                    else presents.Add(curPos, 1);
                }

                QueuedConsole.WriteImmediate("Number of houses receive at least one present : {0}", presents.Count);
            }

            internal static void SantaAndRobotSantaDeliversPresents()
            {
                string s = string.Empty;
                using (var stream = Utility.GetEmbeddedResourceStream("AdventOfCode.Data.Day3.txt", true))
                {
                    using (StreamReader sr = new StreamReader(stream))
                    {
                        while ((s = sr.ReadLine()) != null)
                        {
                            break;
                        }
                    }
                }

                Dictionary<string, int> presents = new Dictionary<string, int>();
                int curSantaX = 0, curSantaY = 0;
                int curRobotSantaX = 0, curRobotSantaY = 0;
                presents.Add("0#0", 2);
                bool isRobot = false;
                foreach (char c in s)
                {
                    if (!isRobot) {
                        if (c == '>') curSantaX += 1;
                        else if (c == '<') curSantaX -= 1;
                        else if (c == '^') curSantaY += 1;
                        else if (c == 'v') curSantaY -= 1;
                    } else {
                        if (c == '>') curRobotSantaX += 1;
                        else if (c == '<') curRobotSantaX -= 1;
                        else if (c == '^') curRobotSantaY += 1;
                        else if (c == 'v') curRobotSantaY -= 1;
                    }

                    string curPos = !isRobot ? curSantaX + "#" + curSantaY : curRobotSantaX + "#" + curRobotSantaY;
                    if (presents.ContainsKey(curPos)) presents[curPos] += 1;
                    else presents.Add(curPos, 1);

                    isRobot = !isRobot;
                }

                QueuedConsole.WriteImmediate("Number of houses receive at least one present : {0}", presents.Count);
            }
        }

        internal class Day4
        {
            static string SecretKey = "ckczppom";

            /// <summary>
            /// http://adventofcode.com/day/4
            /// </summary>
            public static void LowestNumberWith5Zeroes()
            {
                long n = 1;
                using (System.Security.Cryptography.MD5 md5 = System.Security.Cryptography.MD5.Create())
                {
                    while (true)
                    {
                        byte[] inputBytes = Encoding.ASCII.GetBytes(SecretKey + "" + n);
                        byte[] hashBytes = md5.ComputeHash(inputBytes);

                        StringBuilder sb = new StringBuilder();
                        for (int i = 0; i < hashBytes.Length; i++)
                        {
                            sb.Append(hashBytes[i].ToString("X2"));
                        }

                        if (sb.ToString().StartsWith("00000")) break;
                        n++;
                    }
                }

                QueuedConsole.WriteImmediate("Lowest number : {0}", n);
            }

            public static void LowestNumberWith6Zeroes()
            {
                long n = 1;
                using (System.Security.Cryptography.MD5 md5 = System.Security.Cryptography.MD5.Create())
                {
                    while (true)
                    {
                        byte[] inputBytes = Encoding.ASCII.GetBytes(SecretKey + "" + n);
                        byte[] hashBytes = md5.ComputeHash(inputBytes);

                        StringBuilder sb = new StringBuilder();
                        for (int i = 0; i < hashBytes.Length; i++)
                        {
                            sb.Append(hashBytes[i].ToString("X2"));
                        }

                        if (sb.ToString().StartsWith("000000")) break;
                        n++;
                    }
                }

                QueuedConsole.WriteImmediate("Lowest number : {0}", n);
            }
        }

        internal class Day5
        {
            const string vowels = "aeiou";
            static string[] disAllowed = new string[] { "ab", "cd", "pq", "xy" };
            /// <summary>
            /// http://adventofcode.com/day/5
            /// </summary>
            public static void CountNiceStrings()
            {
                int niceStrings = 0;
                int badStrings = 0;
                string s = string.Empty;
                using (var stream = Utility.GetEmbeddedResourceStream("AdventOfCode.Data.Day5.txt", true))
                {
                    using (StreamReader sr = new StreamReader(stream))
                    {
                        while ((s = sr.ReadLine()) != null)
                        {
                            bool nS = false;
                            if (disAllowed.Count(x => s.IndexOf(x) >= 0) == 0)
                            {
                                if (s.Count(c => vowels.Contains(char.ToLower(c))) >= 3)
                                {
                                    if (Enumerable.Range(0, s.Length - 1).Count(t => s[t].Equals(s[t + 1])) > 0)
                                    {
                                        niceStrings++;
                                        nS = true;
                                    }
                                }
                            }
                            if (!nS) badStrings++;
                        }
                    }
                }

                QueuedConsole.WriteImmediate("Nice strings : {0}", niceStrings);
                QueuedConsole.WriteImmediate("Bad strings : {0}", badStrings);
            }

            /// <summary>
            /// http://adventofcode.com/day/5
            /// </summary>
            public static void CountNiceStringsPart2()
            {
                int niceStrings = 0;
                int badStrings = 0;

                int cond1 = 0;
                int cond2 = 0;

                string s = string.Empty;
                using (var stream = Utility.GetEmbeddedResourceStream("AdventOfCode.Data.Day5.txt", true))
                {
                    using (StreamReader sr = new StreamReader(stream))
                    {
                        while ((s = sr.ReadLine()) != null)
                        {
                            bool nS = false;
                            int nCount = 0;
                            bool condi1 = false;
                            bool condi2 = false;
                            for (int i = 0; i < s.Length - 1; i++)
                            {
                                nCount = 0;
                                string c1c2 = s.Substring(i, 2);
                                char c1 = c1c2[0], c2 = c1c2[1];
                                //if (c1.Equals(c2))
                                //{
                                //    string c3 = c1 + "" + c1 + "" + c1;
                                //    if (s.IndexOf(c3) >= 0) { continue; }
                                //}
                                string subS = s.Substring(i, s.Length - i);
                                while (true)
                                {
                                    int index = subS.IndexOf(c1c2);
                                    if (index >= 0) {
                                        nCount++;
                                        subS = subS.Remove(index, 2);
                                    }
                                    else break;
                                }
                                if (nCount >= 2) {
                                    condi1 = true;
                                    break;
                                }
                            }
                            if (condi1) cond1++;

                            for (int i = 0; i < s.Length - 2; i++)
                            {
                                if (s[i].Equals(s[i + 2]))
                                {
                                    if (condi1) {
                                        QueuedConsole.WriteImmediate("{0}", s);
                                        nS = true;
                                        niceStrings++;
                                    }

                                    condi2 = true;
                                    break;
                                }
                            }

                            if (condi2) cond2++;

                            if (!nS) badStrings++;
                        }
                    }
                }

                QueuedConsole.WriteImmediate("Strings satisfying condition 1: {0}", cond1);
                QueuedConsole.WriteImmediate("Strings satisfying condition 2: {0}", cond2);

                QueuedConsole.WriteImmediate("Nice strings : {0}", niceStrings);
                QueuedConsole.WriteImmediate("Bad strings : {0}", badStrings);
            }
        }
    }
}